<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">Modelo - MonteVer3D</title>
    <meta name="description" content="Detalle del modelo 3D arqueol√≥gico">
    <link rel="icon" type="image/png" href="images/favicon.png">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/model.css">
    
    <!-- Three.js r84 + Loaders -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/84/three.min.js"></script>
    <script src="https://cdn.rawgit.com/mrdoob/three.js/r84/examples/js/loaders/STLLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/mrdoob/three.js@r84/examples/js/loaders/OBJLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/mrdoob/three.js@r84/examples/js/loaders/MTLLoader.js"></script>
    <script src="https://cdn.rawgit.com/mrdoob/three.js/r84/examples/js/controls/OrbitControls.js"></script>
</head>
<body>
    <!-- HEADER & NAVIGATION -->
    <header>
        <nav>
            <div class="logo-container">
                <img src="images/logo/logo-monteverde.png" alt="MonteVer3D Logo" class="logo-monteverde">
                <img src="images/logo/logo-uach.png" alt="Universidad Austral de Chile" class="logo-uach">
            </div>
            <ul class="nav-links" id="navLinks">
                <li><a href="index.html">INICIO</a></li>
                <li><a href="catalog.html">CAT√ÅLOGO</a></li>
                <li><a href="casos.html">CASOS DE USO</a></li>
                <li><a href="index.html#como-funciona">C√ìMO FUNCIONA</a></li>
                <li><a href="about.html">ACERCA DE</a></li>
                <li><a href="index.html#cta-section">CONTRIBUIR</a></li>
                <li><a href="index.html#cta-section">CONTACTO</a></li>
            </ul>
            
            <button class="menu-toggle" id="menuToggle" aria-label="Toggle menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </nav>
    </header>
    
    <!-- Admin Link -->
    <a href="admin/index.html" class="admin-link" title="Panel de Administraci√≥n">üîí</a>

    <!-- BREADCRUMB -->
    <section class="breadcrumb-section">
        <div class="container">
            <div class="breadcrumb">
                <a href="index.html">Inicio</a>
                <span>‚Ä∫</span>
                <a href="catalog.html">Cat√°logo</a>
                <span>‚Ä∫</span>
                <span id="breadcrumbCategory">Categor√≠a</span>
            </div>
        </div>
    </section>

    <!-- 3D VIEWER HERO SECTION -->
    <section class="viewer-hero-section" id="viewerSection" style="display: none;">
        <div class="container">
            <div class="viewer-hero-header">
                <div>
                    <h1 id="modelTitle">Cargando modelo...</h1>
                    <div id="modelBadges" class="model-badges-container"></div>
                    <p id="modelCategory" class="model-category-tag"></p>
                </div>
            </div>
            
            <div class="viewer-hero-container">
                <!-- Enhanced Floating Controls -->
                <div class="viewer-floating-controls">
                    <!-- Material Mode -->
                    <div class="control-group">
                        <button class="viewer-control-btn" onclick="toggleMaterialMode()" title="Cambiar modo de material">
                            üé®
                        </button>
                        <span id="materialModeLabel" class="control-label">Textura</span>
                    </div>
                    
                    <!-- Camera Presets -->
                    <div class="control-group">
                        <button class="viewer-control-btn" onclick="setCameraView('front')" title="Vista Frontal">
                            ‚¨ÜÔ∏è
                        </button>
                        <button class="viewer-control-btn" onclick="setCameraView('top')" title="Vista Superior">
                            üîù
                        </button>
                        <button class="viewer-control-btn" onclick="setCameraView('isometric')" title="Vista Isom√©trica">
                            üìê
                        </button>
                    </div>
                    
                    <!-- Actions -->
                    <div class="control-group">
                        <button class="viewer-control-btn" id="autoRotateBtn" onclick="toggleAutoRotate()" title="Auto-rotaci√≥n">
                            üîÑ
                        </button>
                        <button class="viewer-control-btn" id="screenshotBtn" onclick="takeScreenshot()" title="Captura de pantalla">
                            üì∑
                        </button>
                        <button class="viewer-control-btn" onclick="toggleViewerFullscreen()" title="Pantalla completa">
                            üñ•Ô∏è
                        </button>
                    </div>
                    
                    <!-- Reset -->
                    <button class="viewer-reset-btn" onclick="resetAndScroll()" title="Resetear vista">
                        üîÑ
                    </button>
                </div>
                
                <!-- Three.js canvas -->
                <div id="modelViewer" class="model-viewer-canvas">
                    <div class="viewer-loading">
                        <div class="loader"></div>
                        <p>Cargando modelo 3D...</p>
                    </div>
                </div>
                
                <div class="rotation-hint active" id="rotationHint">
                    <button class="rotation-hint-close" onclick="closeRotationHint()">√ó</button>
                    <span class="rotation-hint-icon">üîÑ</span>
                    <p>Rota tu dispositivo a horizontal para mejor visualizaci√≥n</p>
                </div>
            </div>
        </div>
    </section>

    <!-- MODEL DETAIL CONTENT -->
    <section class="model-detail">
        <div class="container">
            <div class="model-grid">
                <!-- LEFT: Image Gallery + Tags -->
                <div class="gallery-section">
                    <div class="gallery-main">
                        <img id="mainImage" src="" alt="Model preview">
                        <button class="gallery-fullscreen" id="fullscreenBtn" aria-label="Ver en pantalla completa">
                            üîç
                        </button>
                    </div>
                    
                    <div class="gallery-thumbnails" id="galleryThumbnails">
                    </div>

                    <div class="detail-card" style="margin-top: 1rem;">
                        <h3>Etiquetas</h3>
                        <div id="modelTags" class="tags-container">
                        </div>
                    </div>
                </div>

                <!-- RIGHT: Model Details -->
                <div class="details-section">
                    <div class="detail-card">
                        <h3>Descripci√≥n</h3>
                        <p id="modelDescription"></p>
                    </div>

                    <div class="detail-card">
                        <h3>Informaci√≥n del Modelo</h3>
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">Categor√≠a:</span>
                                <span id="infoCat"></span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Tipo:</span>
                                <span id="infoType"></span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Fuente:</span>
                                <span id="infoSource"></span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">M√©todo:</span>
                                <span id="infoOrigin"></span>
                            </div>
                            <div class="info-item" id="fileInfoContainer" style="display: none;">
                                <span class="info-label">Archivo:</span>
                                <span id="infoFile"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Notes Section -->
            <div id="notesSection" class="notes-section" style="display: none;">
                <h2>üìù Notas Adicionales</h2>
                <div id="notesContainer" class="notes-display">
                </div>
            </div>
            
            <!-- Attribution Card -->
            <div class="attribution-card">
                <h3>üìú Atribuci√≥n y Licencia</h3>
                <div class="attribution-content">
                    <div class="attribution-item">
                        <span class="attribution-label">Creador:</span>
                        <span id="attrCreator"></span>
                    </div>
                    <div class="attribution-item">
                        <span class="attribution-label">Licencia:</span>
                        <span id="attrLicense"></span>
                    </div>
                    <div class="attribution-item" id="attrSourceContainer">
                        <span class="attribution-label">Fuente:</span>
                        <span id="attrSourceName"></span>
                    </div>
                    <div class="attribution-item" id="attrModsContainer" style="display: none;">
                        <span class="attribution-label">Modificaciones:</span>
                        <span id="attrModifications"></span>
                    </div>
                </div>
            </div>

            <!-- ACTION BUTTONS -->
            <div class="action-buttons" id="actionButtons">
            </div>
        </div>
    </section>

    <!-- RELATED MODELS -->
    <section class="related-models" id="relatedSection" style="display: none;">
        <div class="container">
            <h2>Modelos Relacionados</h2>
            <div id="relatedModels" class="models-grid">
            </div>
        </div>
    </section>

    <!-- LIGHTBOX -->
    <div id="lightbox" class="lightbox">
        <button class="lightbox-close" id="lightboxClose">‚úï</button>
        <button class="lightbox-prev" id="lightboxPrev">‚Äπ</button>
        <button class="lightbox-next" id="lightboxNext">‚Ä∫</button>
        <img id="lightboxImage" src="" alt="">
    </div>

    <!-- FOOTER -->
    <footer>
        <div class="footer-content">
            <p>&copy; 2026 MonteVer3D - Universidad Austral de Chile, Puerto Montt</p>
            <p style="margin-top: 1rem; font-size: 0.9rem;">
                Proyecto de Conservaci√≥n Digital del Patrimonio | Desarrollado por TecMedHUB
                <a href="mailto:fernanda.lopez@uach.cl" style="color: var(--color-primary);">fernanda.lopez@uach.cl</a>
            </p>
        </div>
    </footer>

    <!-- SCRIPTS -->
    <script src="js/nav.js"></script>
    <!-- 3D Viewer Modules (order matters) -->
    <script src="js/material-modes.js"></script>
    <script src="js/loader-utils.js"></script>
    <script src="js/viewer-controls.js"></script>
    <script src="js/model-viewer.js"></script>
</body>
</html>
